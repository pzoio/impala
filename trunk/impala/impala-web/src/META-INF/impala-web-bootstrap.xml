<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
http://www.springframework.org/schema/beans 
http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
 	
 <bean id="typeReaders" 
	 class = "org.impalaframework.web.type.WebTypeReaderRegistryFactoryBean">
 </bean>
 
 <bean id="servletContextWrapper" 
	 class="org.impalaframework.web.servlet.wrapper.IdentityServletContextWrapper">
 </bean>	 	
 	
 <bean id="baseModuleLoader" abstract="true">
	 <property name = "classLoaderFactory" ref = "classLoaderFactory"/>
 </bean>	 	
 	
 <!-- looks for spring locations in class path -->
 <bean id="rootModuleLoader" 
	 class="org.impalaframework.web.module.WebClasspathRootModuleLoader"
	 parent = "baseModuleLoader">
	<constructor-arg ref="moduleLocationResolver"/>
	 <property name = "servletContextWrapper" ref = "servletContextWrapper"/>
 </bean>	
	
 <!-- looks for spring locations in servlet context -->
 <bean id="webRootModuleLoader" 
	 parent="baseModuleLoader"
	 class="org.impalaframework.web.module.WebRootModuleLoader">
	<constructor-arg ref="moduleLocationResolver"/>
	 <property name = "servletContextWrapper" ref = "servletContextWrapper"/>
 </bean>	
	
 <!-- looks for spring locations in class path -->
 <bean id="servletModuleLoader" 
	 parent = "baseModuleLoader"
	 class="org.impalaframework.web.module.ServletModuleLoader">
	<constructor-arg ref="moduleLocationResolver"/>
	 <property name = "servletContextWrapper" ref = "servletContextWrapper"/>
 </bean>	
	
 <bean id="webPlaceholderModuleLoader" class="org.impalaframework.web.loader.WebPlaceholderDelegatingContextLoader"/>			
	
 <bean id="moduleLoaderRegistry" class="org.impalaframework.module.loader.ModuleLoaderRegistry">
	<property name = "moduleLoaders">
		<map>
			<entry key="root" value-ref="rootModuleLoader"/>
			<entry key="application" value-ref="applicationModuleLoader"/>
			<entry key="application_with_beansets" value-ref="applicationBeansetModuleLoader"/>
			<entry key="web_root" value-ref="webRootModuleLoader"/>
			<entry key="servlet" value-ref="servletModuleLoader"/>
		</map>
	</property>	
	<property name = "delegatingLoaders">
		<map>
			<entry key="web_placeholder" value-ref="webPlaceholderModuleLoader"/>
		</map>
	</property>  
 </bean>

</beans>