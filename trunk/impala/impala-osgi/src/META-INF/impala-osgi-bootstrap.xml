<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
http://www.springframework.org/schema/beans 
http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

 <bean id="classLoaderFactory" class="org.impalaframework.osgi.classloader.OsgiClassLoaderFactory"/>
 
 <bean id="moduleStateHolder" class="org.impalaframework.module.holder.graph.GraphModuleStateHolder">
     <property name="transitionProcessorRegistry" ref="transitionProcessorRegistry"/>    
     <property name="moduleStateChangeNotifier" ref="moduleStateChangeNotifier"/>
 </bean>
 
 <bean id="strictModificationExtractor" class="org.impalaframework.module.modification.graph.GraphModificationExtractor">
     <property name = "moduleStateHolder" ref = "moduleStateHolder"/>
 </bean>
    
 <bean id="stickyModificationExtractor" class="org.impalaframework.module.modification.graph.StickyGraphModificationExtractor">
     <property name = "moduleStateHolder" ref = "moduleStateHolder"/>
 </bean> 
 
 <bean id="baseModuleLoader" abstract="true">
     <property name = "classLoaderFactory" ref = "classLoaderFactory"/>
     <property name = "moduleLocationResolver" ref="moduleLocationResolver"/>
 </bean>        
    
 <bean id="rootModuleLoader" 
     parent="baseModuleLoader"
     class="org.impalaframework.osgi.module.spring.loader.OsgiModuleLoader">          
    <property name = "serviceRegistry" ref="serviceRegistry"/>    
 </bean>    
    
 <bean id="applicationModuleLoader" 
     parent="baseModuleLoader"
     class="org.impalaframework.osgi.module.spring.loader.OsgiModuleLoader">
    <property name = "serviceRegistry" ref="serviceRegistry"/>      
 </bean>
 
 <bean id="loadTransitionProcessor" class="org.impalaframework.osgi.module.transition.OsgiLoadTransitionProcessor">
    <property name = "moduleRuntimeManager" ref="moduleRuntimeManager"/>         
    <property name = "moduleLoaderRegistry" ref="moduleLoaderRegistry"/>         
 </bean>
    
 <bean id="unloadTransitionProcessor" class="org.impalaframework.osgi.module.transition.OsgiUnloadTransitionProcessor">    
    <property name = "moduleRuntimeManager" ref="moduleRuntimeManager"/>      
 </bean>

</beans>
